#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "Running pre-push checks..."
echo "Testing with coverage validation (requires 90% minimum)..."

# Run tests with coverage
npm run test:coverage

# Check the exit code
if [ $? -ne 0 ]; then
  echo ""
  echo "PUSH BLOCKED: Test coverage is below 90% threshold"
  echo "Please add tests to increase coverage before pushing"
  echo ""
  echo "To bypass this check (NOT RECOMMENDED), use:"
  echo "git push --no-verify"
  echo ""
  exit 1
fi

echo ""
echo "Coverage threshold met! Proceeding with push..."
echo ""
